package com.logpresso.scanner;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Arrays;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;

import com.logpresso.scanner.utils.IoUtils;

public class VersionClassifier {
	private static final char[] HEX_CODES = "0123456789abcdef".toCharArray();
	private static final Map<String, String> log4j1Digests;

	private static final Map<String, String> log4j2RollingFileManagerDigests;
	private static final Map<String, String> log4j2AppenderControlDigests;
	private static final Map<String, String> log4j2LoggerConfigDigests;
	private static final Map<String, String> log4j2ThreadContextMapDigests;
	private static final Map<String, String> log4j2OutputStreamManagerDigests;
	private static final Map<String, String> log4j2AsyncLoggerDigests;
	private static final Map<String, String> log4j2AsyncAppenderDigests;
	private static final Map<String, String> log4j2InterpolatorDigests;
	private static final Map<String, String> jndiManagerDigests;
	private static final Map<String, String> springJarDigests;
	private static final Map<String, String> springCachedIntrospectionResultsDigests;
	private static final Map<String, String> springRoutingFunctionDigests;

	static {
		log4j1Digests = new HashMap<>();
		log4j1Digests.put("906c9e0fd306e8b499b7f2dc84e2fef3", "1.1.3");
		log4j1Digests.put("37fa11f47f3b8d40882f8ee61b06e69f", "1.2.4");
		log4j1Digests.put("3f2f6a1ac893cb01c8f749036a1be514", "1.2.8");
		log4j1Digests.put("caea0074e17f5f84ee60804781f2f2a0", "1.2.9");
		log4j1Digests.put("d0b058288138bda4fccb504d4046e08c", "1.2.11");
		log4j1Digests.put("6bac921015bb8300d36df01d0bf1ceb4", "1.2.12");
		log4j1Digests.put("ff67193faa9007c0afc57dbc04c983bb", "1.2.15");
		log4j1Digests.put("bd5186a7747acdd133105873fbfefdb1", "1.2.16");
		log4j1Digests.put("e8dedc13853f852f1af6900d2d9c73b3", "1.2.17");
		log4j1Digests.put("1bd049612eaddf4fe8a8bc3cb2179dbf", "1.2.17"); // with generics

		log4j2RollingFileManagerDigests = new HashMap<>();
		log4j2RollingFileManagerDigests.put("66c1b131a623bd368e6d8bebbe16ff0c", "2.0-alpha1");
		log4j2RollingFileManagerDigests.put("ea91f7e905890c4748a97e09937d3b87", "2.0-alpha2");
		log4j2RollingFileManagerDigests.put("d09d7e21eea3985436167edc8bb8683b", "2.0-beta1");
		log4j2RollingFileManagerDigests.put("7353cce6841e400fd840887cba14d55d", "2.0-beta2");
		log4j2RollingFileManagerDigests.put("3e3f74e5af5d0b22a5e38b877f500711", "2.0-beta3");
		log4j2RollingFileManagerDigests.put("167dfbf8e4da0fccc1145f841ac3d035", "2.0-beta4");
		log4j2RollingFileManagerDigests.put("d02e41ca06e35a28dbda2e8721142a72", "2.0-beta9");
		log4j2RollingFileManagerDigests.put("8e8beef8634c0aff2e5d63fcc87c6661", "2.0-rc1");
		log4j2RollingFileManagerDigests.put("7918c364db8a499eda4408bb9529fb0e", "2.0-rc2");
		log4j2RollingFileManagerDigests.put("48ecb3c6a378c045482aa4ba3bd1afe5", "2.3");
		log4j2RollingFileManagerDigests.put("fd9d433dc83d1aaf88548e713693d8e2", "2.3.1");
		log4j2RollingFileManagerDigests.put("5e156e9b4ae0e291c0987d9caf3a3f5a", "2.3.2");
		log4j2RollingFileManagerDigests.put("39db3f6132358787af20766bba757574", "2.4");
		log4j2RollingFileManagerDigests.put("a2b1489d08fe47392db0267f42e96938", "2.4.1");
		log4j2RollingFileManagerDigests.put("031c3ae10ee8fd24a9fa00366cc1e010", "2.5");
		log4j2RollingFileManagerDigests.put("1580aa3de80d9ac181c2ae78b1eb777f", "2.6.2");
		log4j2RollingFileManagerDigests.put("7027c29e04281037abfd22ef0b16c3af", "2.7");
		log4j2RollingFileManagerDigests.put("63939a357e427fadb975287084d3dd0f", "2.8");
		log4j2RollingFileManagerDigests.put("46b9a7341456824e15d9d6ad71323039", "2.8.1");
		log4j2RollingFileManagerDigests.put("50ca27cb0b2cf02cc5ef97d3401d4fb5", "2.8.2");
		log4j2RollingFileManagerDigests.put("7dc1c465224f386d404574d76432583c", "2.11.1");
		log4j2RollingFileManagerDigests.put("4206094f030c94db57d75ec11b17b606", "2.11.2");
		log4j2RollingFileManagerDigests.put("dc95679162dde24806281fce2609d84f", "2.12.3");
		log4j2RollingFileManagerDigests.put("d71ec841dcaaa158adda0c326b8b30eb", "2.13.0");
		log4j2RollingFileManagerDigests.put("4bef436fd4aadff166f3ccf49e920208", "2.13.1");
		log4j2RollingFileManagerDigests.put("dd1fd2b1c1bbe6f7543e6fb6c2fd8a78", "2.14.0");
		log4j2RollingFileManagerDigests.put("81b374404981e7739e514de150b16416", "2.14.1");

		log4j2AppenderControlDigests = new HashMap<>();
		log4j2AppenderControlDigests.put("f2b2d44ebdb80db7d87e7d44e050f689", "2.12.4");
		log4j2AppenderControlDigests.put("445b65145d2e9ccbdcd0238e20acc15a", "2.15.0");
		log4j2AppenderControlDigests.put("c41c4e77e28a414e9512e889fe72c26e", "2.16.0");
		log4j2AppenderControlDigests.put("e7cd10930f7efcf09c43fd580f476491", "2.17.0");
		log4j2AppenderControlDigests.put("b1e72c1608d69230e852de53f411553c", "2.17.1");

		log4j2LoggerConfigDigests = new HashMap<>();
		log4j2LoggerConfigDigests.put("17ad30e070723548423f8b01f892cea5", "2.0-beta5");
		log4j2LoggerConfigDigests.put("5d6696388448e169cd29ee5426187bc5", "2.0-beta6");
		log4j2LoggerConfigDigests.put("8353ff994104395cedf609330b0c13ed", "2.0-beta7");
		log4j2LoggerConfigDigests.put("fd9c4cbc794aa8cc56e261f7f193ff17", "2.0-beta8");
		log4j2LoggerConfigDigests.put("a73f488fd9770a6ba44b1944e879622d", "2.12.0");
		log4j2LoggerConfigDigests.put("54da0558628cfabae6eeeabf9d284f8e", "2.12.1");

		log4j2ThreadContextMapDigests = new HashMap<>();
		log4j2ThreadContextMapDigests.put("9d7a8b73a4c83493703805bcaa97d5f4", "2.13.2");
		log4j2ThreadContextMapDigests.put("687baf0490162fc956f6365c7894ab1a", "2.13.3");

		log4j2AsyncAppenderDigests = new HashMap<>();
		log4j2AsyncAppenderDigests.put("744dc79c1ce978a5ce6aee7acc63e7de", "2.10.0");
		log4j2AsyncAppenderDigests.put("08ce0e2441b7a51a887489494da447ad", "2.11.0");

		log4j2AsyncLoggerDigests = new HashMap<>();
		log4j2AsyncLoggerDigests.put("f1b4a01e8163a752e4bd969433d70481", "2.9.0");
		log4j2AsyncLoggerDigests.put("10a184fde310fb171cd668b39a8f63fb", "2.9.1");

		log4j2OutputStreamManagerDigests = new HashMap<>();
		log4j2OutputStreamManagerDigests.put("0d67bfd717ee9cc3b5b35d5083e6d01a", "2.6");
		log4j2OutputStreamManagerDigests.put("c46438987ce8df640eab163bb20a3d83", "2.6.1");

		log4j2InterpolatorDigests = new HashMap<>();
		log4j2InterpolatorDigests.put("763b4af13fd37d076122b2c9aff02790", "2.12.2");

		// known shaded md5 hashes
		jndiManagerDigests = new HashMap<>();

		// https://download.newrelic.com/newrelic/java-agent/newrelic-agent/current/newrelic.jar
		jndiManagerDigests.put("e2c6b2691738bb653f1ff6dc4b967a42", "2.17.1");
		
		springJarDigests = new HashMap<>();
		springJarDigests.put("a641cbba918908242c5d9d6c624d1e15007890886ade13257837d93d2efecef7", "1.2-rc1");
		springJarDigests.put("9218328ec3e6be246314a228c446d1d14e030197d9a40c4a5fbb22bfe79991e7", "1.2-rc2");
		springJarDigests.put("3722773cecc67cde76dfb2f48a5bb50bc681ebb4a4d157243c0eace0fd2c9976", "1.2.1");
		springJarDigests.put("4a1b6b50c8e769bdc467177e31af0a3ac682d1868e32cbc7be115bb34301fba2", "1.2.2");
		springJarDigests.put("e03001bdbfbbcf3117440b7f4c06c614f844150d07ff1029333da6e4bf4d0156", "1.2.3");
		springJarDigests.put("4ed90b4fc3bbe6ff16cd7a8ceb43d06cc40face9d491b6d566f410096b42eb92", "1.2.4");
		springJarDigests.put("461736db6cadf375e8a5eb21a90b2a354722b7aa723a28ef20de826013649f02", "1.2.5");
		springJarDigests.put("b4d103996825ca1f9b3cd70aab322e7b315108c92a4cc1105841ef0f7d32bcae", "1.2.6");
		springJarDigests.put("473f32615143209e8bf161e01928055157669453deb76d0b9525e94d40701d75", "1.2.8");
		springJarDigests.put("7a6e98cc30c2fcbe9cee19b10be1ffb25b249c360f6adbeb0a6002f931f733ea", "1.2.9");
		springJarDigests.put("9bd58461553810e6b1d38b11ddb57a99724d2208d03a2794e8199412d858dcc1", "1.2");
		springJarDigests.put("7dd9376ec02b76d3da67ec98356a9c35f2f11c243075858d07008d800d7ea3ef", "2.0-m1");
		springJarDigests.put("d833342086ee83e249d4142ae8389a0dbcda5b14b28d687e1b4e9a39c2460350", "2.0-m2");
		springJarDigests.put("2eb874942c3522819cb847aaa28dbcc6473370fb34d632793e1d57cdcd0dd289", "2.0-m3");
		springJarDigests.put("d3cd20e275c4b05381a918947f4aa3b91a764479039310a0dc5663ef3689b35c", "2.0-m4");
		springJarDigests.put("71f4a5a4b3dcc2492f91c4b17f4b20d3ebeb8fb6402bb28853e9658626a2a370", "2.0-rc1");
		springJarDigests.put("5695271ad4f62a002feef4f85a486f963f5df613ab35f5d46c312abac49bd1b6", "2.0-rc2");
		springJarDigests.put("d0a6db012ae7c491420e14749b57fca779aff62e1cc4689324aa712430df805b", "2.0.1");
		springJarDigests.put("3a278529027cea3653911c71a944816799d85d785880bad3a714c7bb68807c55", "2.0.2");
		springJarDigests.put("3d71e0e414594789d617ef0760a159f465db7f19fd2c11ed589bd9e13335c25d", "2.0.4");
		springJarDigests.put("eeaaac30a472a055a9063a110b78c80080fc8ca35b425d8f07207cce45c6bb1c", "2.0.5");
		springJarDigests.put("63544062fe7cf8166a422753f52dad709fbdfb2bf66ec0ee8b62e7d90fea7528", "2.0.6");
		springJarDigests.put("4a7c4ca5f7b3a2e24c1022a78dc8a466a0191549ea806fa7e7a67d4e9318c7a0", "2.0.7");
		springJarDigests.put("9cfbacf832b7e10676a54d9b5b72fa972ca8a644745b1079b9a1564155854f45", "2.0.8");
		springJarDigests.put("479fd8e68cde3ce460660cda5d20a4701459500c19509be47a23c1c30112beef", "2.5.1");
		springJarDigests.put("114c55bed5fc4847fb1fefe8462f65b0e89bc216a0d31f6325f021c6b2381312", "2.5.2");
		springJarDigests.put("1d1e9df5d7d3ef29755889254a62b9e1784630052407f3ea51b60e676edeb3fb", "2.5.3");
		springJarDigests.put("69a94e366da93af085ec346fa5c93442de0f919efd7b983e9e514af2fe6e143b", "2.5.5");
		springJarDigests.put("0b53260c6e85c6848a4ae181f790696acd9e784dbaf05f8cee9acdda8afff4c2", "2.5.6.SEC01");
		springJarDigests.put("b6a7845ff9068b36a67d7c7bf41afbcd76413ff63e7bec2414133a18ef330b7a", "2.5.6.SEC02");
		springJarDigests.put("d33246bb33527685d04f23536ebf91b06ad7fa8b371fcbeb12f01523eb610104", "2.5.6");
		springJarDigests.put("0add4113f10bd6681b39e969ad5b7bf3ed2b6ebdbd0ae07b64ee4af1b5f0b2a0", "2.5");
		springJarDigests.put("4271b137c17b9367ad06267079a28ae4dfdd493d4c9d15c7437a48dcae38b28c", "3.0.0.RELEASE");
		springJarDigests.put("e0b8fc0c39349b8a9b5ac4f0276109c39f2e6c6a2de74ab1c1530122d4a3e5a8", "3.0.2.RELEASE");
		springJarDigests.put("ea514ebc81da83161ac163831500e58d4f7199d0cfe12d14eaa11b42953b5771", "3.0.3.RELEASE");
		springJarDigests.put("ab6c3906ea07d6652633538c67014eb840b4fd57fba1fc6dc47152013dc50106", "3.0.5.RELEASE");
		springJarDigests.put("2570f90c86ef7a5f09dc36f28f05a1c24179971acae84fa5f837dcc82cb0c33e", "3.0.6.RELEASE");
		springJarDigests.put("a7ae604dd25f6caa1729a63bfa01b8bf4d05ca8a7169d46b6078fa921c667f6f", "3.0.7.RELEASE");
		springJarDigests.put("3540ef743e77825c69971b6c3925df2a855dbdff4dae44db7fb642d51f9400c5", "3.1.1.RELEASE");
		springJarDigests.put("685f0759b30c9413e689e906cf3e0717d6b01a044dc00b04be0b56c028c5b550", "3.1.2.RELEASE");
		springJarDigests.put("df74f8eb302dd1ef078031c24bad4677ae2b2d6b0ef5a186c51168e6bcee50b5", "3.1.4.RELEASE");
		springJarDigests.put("f73909a197c72fe98c19d924136c2699e9ba2d701e6d6a5a5e232e8be42d0e52", "3.2.0.RELEASE");
		springJarDigests.put("b6563a290f5f8a40c549ea0b6dbd67a8fb41cd654fa8cc132452146f81214dc9", "3.2.1.RELEASE");
		springJarDigests.put("603de664d1f51f35cedc7995b4d4d9d76aa9e061d8e765428df4d5c3fb0c7dff", "3.2.11.RELEASE");
		springJarDigests.put("c79c3f5f5f62bfbc6a8637293dffd3c7af932755a2916393c232648492f01e2f", "3.2.12.RELEASE");
		springJarDigests.put("3b03774fe60911d4167d322cc7689be3df33c249f22d928aacecc78d27c8f073", "3.2.14.RELEASE");
		springJarDigests.put("9e0142f6dc0fe58c4a2df3d926fb4343787a4ce9d19f474c3b56e3acfc8997ab", "3.2.15.RELEASE");
		springJarDigests.put("265b257bc2db930fb814bc27dcacf3a30d1057436a88e2091c93ed2def304ea3", "3.2.17.RELEASE");
		springJarDigests.put("3ca7e8e3a2a053229fef927a315f038ee94a79368c396e50727eeedce9aef2c9", "3.2.18.RELEASE");
		springJarDigests.put("387025a34350812978f39c5cd89484379702d617712f23f567f0dd61952aa573", "3.2.4.RELEASE");
		springJarDigests.put("b31d4ee6144da90546363a52346b1c101e10c99af96a0393533afd5ed3f98f9d", "3.2.5.RELEASE");
		springJarDigests.put("0533a84d689365699c468f0e6b84f5fd822ab0c4ce1e09c2d673313a087d9e3a", "3.2.7.RELEASE");
		springJarDigests.put("caa6d6daaab7829abf87ac9b22a3dbec5d58549a4d489c19367155055f8dc010", "3.2.8.RELEASE");
		springJarDigests.put("6366e84278e827bcb3cb68041bab7318727c83d7dad7a9e439162aec9e711980", "3.2.9.RELEASE");
		springJarDigests.put("e27e14f2eff27a97563b0f7dec4a81ab1ffc0d088c29e68eea189f148bc591c8", "4.0.1.RELEASE");
		springJarDigests.put("eeec5762999af8079c3363c9112344d830f70a605f720b5c68a1fd1350cc8d80", "4.0.2.RELEASE");
		springJarDigests.put("bbe70bf71016a47418797ed40969a836a2090af8e56375dff7e209e00b4aea2d", "4.0.4.RELEASE");
		springJarDigests.put("0b506df2e1f59e2c894e109762a6bfee55fbdfdb81d15f66b2c617d1d2c77e7d", "4.0.5.RELEASE");
		springJarDigests.put("21103a81e9da152abfda773b8d9f0cf173729e531194772188ec15401e759eba", "4.0.7.RELEASE");
		springJarDigests.put("89105ba2af53e415af3fe137ae251e747650e48118aae136d56632cf06b1e1ca", "4.0.8.RELEASE");
		springJarDigests.put("56c99ed15ed2e4380fe04ffe951b02c6dadb08583889b47f0c2f5156eb1e7d16", "4.1.0.RELEASE");
		springJarDigests.put("d85cce5c0b06a4ded99150676ea3e5a59a3dda0db5940b5d99b757b221c72acd", "4.1.1.RELEASE");
		springJarDigests.put("94f160690e4d5f80a0444088aaf235086b448f3903043da06f24ff4b713fb713", "4.1.3.RELEASE");
		springJarDigests.put("2224dfb1ae4c4630146998f9f9e44364a4ab99ba6ffcdbbf81c6aeb9c58bbab8", "4.1.5.RELEASE");
		springJarDigests.put("b04ccc5aac8b2e712c33ca0b5e93b401dc4381e025cd94c60a87579bbcac1d5e", "4.1.6.RELEASE");
		springJarDigests.put("a51bff1168f37e643118bd28180523f17976db8b4eafde542f63725418c0d0a4", "4.1.8.RELEASE");
		springJarDigests.put("cb677671c5c74f787642324e1ed61afb00c50e7a62fb5c3dce93dbffe73645cb", "4.1.9.RELEASE");
		springJarDigests.put("55442596df4e0778e0bb6c9094d703549e364dd48bbf71d1c5a354dd2d95b4a7", "4.2.1.RELEASE");
		springJarDigests.put("7814419f421a58d66fc586851685e383919de381fdc8921ec9f4fb67dee563af", "4.2.2.RELEASE");
		springJarDigests.put("d47cf4b4294966239600c8e044e557646fb139dae758f857494ee1c1ab1e2046", "4.2.4.RELEASE");
		springJarDigests.put("8ad81e4b404684f6cc9501491d14761ac7d186106608a51f69d931426243ec10", "4.2.5.RELEASE");
		springJarDigests.put("7d863ede27b894865b3dbfad128602a1853bd3e39b1c31a2d100f7cf1996a4ee", "4.2.7.RELEASE");
		springJarDigests.put("5c83be1169fb272c217500eb44c03bff44a4e56f8a8debeb9ebfb68272215dd7", "4.2.8.RELEASE");
		springJarDigests.put("b50e9413a4ae780b613fcecf65b6c0270f28e86876b0874dbca4e9f88af95f6e", "4.3.0.RELEASE");
		springJarDigests.put("44d5dca971b2ab6454d125ab271c1f32dff035bc578792c8ed702f0c57ac5a2a", "4.3.1.RELEASE");
		springJarDigests.put("9f7d87ff3683ebc491bf34630fc9fb44228e51e69bb81131f7ebdfc96796337b", "4.3.11.RELEASE");
		springJarDigests.put("72287ccbfa246cbabb718414d74c2cf56d5fb0b3d8145a726a1f9b09acd25cd8", "4.3.12.RELEASE");
		springJarDigests.put("62ba63c30d30a221b69ce77d5d626554af1d61dc736cebd45ba7c688ee1048ab", "4.3.14.RELEASE");
		springJarDigests.put("8dc528e4e9998f626a6072a087d8d155a3c833515790dff01785b7efe86d7f5a", "4.3.16.RELEASE");
		springJarDigests.put("6ea0cae9ce926db7227d3e5d8e11e4f75663f6de08702868c320ea32a2c0c015", "4.3.17.RELEASE");
		springJarDigests.put("88785cd6d433df6d69224622f52cedfc29d1e7a38c61d7dac29c75965cb93fcd", "4.3.19.RELEASE");
		springJarDigests.put("371db87afff450333044949529d0de193aa55e1c789ec4553cca18d3f4f39cf2", "4.3.2.RELEASE");
		springJarDigests.put("6b6f6bca063d4c29f487d9480b48f392b308c20fa2b14934375044f502e91361", "4.3.21.RELEASE");
		springJarDigests.put("c9a97296f07e8e96d3d3f63c9cb3700c4baf4c2ecf6463a1a1c920b463ee45b6", "4.3.22.RELEASE");
		springJarDigests.put("364926a54114ec84772310e486ce080655a85a45c704e54d44a7bfab9aaa873b", "4.3.24.RELEASE");
		springJarDigests.put("fd7d135ee5dfa3d72ba4f195ba42127b84968c3bc12fb1a2496512778f5b3c77", "4.3.26.RELEASE");
		springJarDigests.put("e52fe430ba9f19be62da1882fbd43222f8be4cf42860472ad81e991c832c1c5a", "4.3.27.RELEASE");
		springJarDigests.put("a1ac25edb27aa17ec3ddd4fc05982b6b12ce9d743fb2c1c630d9405da21a257f", "4.3.29.RELEASE");
		springJarDigests.put("59c0c1f9c5079310334b4962798c5db9f5cfecf6c4278f8a3b454da727083a86", "4.3.3.RELEASE");
		springJarDigests.put("3022a556842e191dcd4b33dcd04657890ff0fdcf40f9943aa8c3d809a9de8d6e", "4.3.4.RELEASE");
		springJarDigests.put("da9e4ef3716d2fac235767107e12e906bfc8da10b4b61c0725daf277dcc20c8f", "4.3.5.RELEASE");
		springJarDigests.put("515cb4b7987aea17e1c02e9b9f64f44ad44b645de4bd2417b88bfb7550068bb8", "4.3.7.RELEASE");
		springJarDigests.put("6190599448d7ee68f4b4dd17fc6d963c9f721f34736cdc85273b56ce9fb9ee0d", "4.3.9.RELEASE");
		springJarDigests.put("062cd8eb1ed897f05d742f0ae00f87c041ba1bd28f0ed260849e30aca352494f", "5.0.0.RELEASE");
		springJarDigests.put("2d88012690cbb45d0afaa33417a5c7e24fc9a42c16c65cb25ffe939430a47730", "5.0.10.RELEASE");
		springJarDigests.put("37122e1f376f412289e9f4bb3767a870592fdf47d555448425479453ee520e64", "5.0.11.RELEASE");
		springJarDigests.put("af2afab52ff8ad7777f6a239837fabc329fc88509b98b023f0c7e8bcbddd0ffd", "5.0.13.RELEASE");
		springJarDigests.put("840056ad4625308728883b4f2568bc8360ae2374c7bde761c07115306cd18c47", "5.0.14.RELEASE");
		springJarDigests.put("0e0b943cb1e76d11bd2575b2dd25f800f4faa50343933e3251e8fda745f30d6d", "5.0.15.RELEASE");
		springJarDigests.put("d671cebd74b33d2e47a4882b202ba39cf3604cebd6fb6fb422076c117763cba3", "5.0.17.RELEASE");
		springJarDigests.put("2e886923eba3d13c6fb7b7894b409190476c82312df27793d9a5ac6a70f85e7e", "5.0.18.RELEASE");
		springJarDigests.put("11899e7e0aaca6fa63c3608e751964cd280395806df1e65c738f188cb52c4020", "5.0.2.RELEASE");
		springJarDigests.put("7d10d8df090f111c1e419a1a85d808e89fb95abd62e0e7d4da592c792238bed8", "5.0.20.RELEASE");
		springJarDigests.put("cd559673273afb16f7580ab063f07e9821f644a7f471a41179e5fead45c7f708", "5.0.4.RELEASE");
		springJarDigests.put("dab1f19aafd2d53137c886b806cdc2a4f2193e66f55b96a37d10fb92fd204663", "5.0.5.RELEASE");
		springJarDigests.put("0d0adc1832406304985a72d2c79c6d0af481f34ae2a9c4a3835c9b0968da25e3", "5.0.7.RELEASE");
		springJarDigests.put("b846720875814e9a383421af0c6a2026e563ec903b2e437926792fea493fe84d", "5.0.8.RELEASE");
		springJarDigests.put("e2b00ade5ffbacbb30e529919f6132cc1fce1e5883fb33840ebae6b190eab64e", "5.1.0.RELEASE");
		springJarDigests.put("57d7094cf81d5fb11acf68f8b103dd125159b4eab9c85438d61e56c237c8b759", "5.1.1.RELEASE");
		springJarDigests.put("c82469fd2715bdb3194dff9ab3fbb215f351473d428fc169328d975b30992b9d", "5.1.10.RELEASE");
		springJarDigests.put("2097e8357dc6f5e67e4a165155d68710ff0166906378fc2e4a41f0854d64d46f", "5.1.12.RELEASE");
		springJarDigests.put("f7552c59e527d596ceea7adba4ef47c9e4afd8e709dce259fcc5531e19814880", "5.1.13.RELEASE");
		springJarDigests.put("32ab12c5e0e43f75244030fb5245922df22d1f5aea89bff7ff533623b8e8a1f9", "5.1.15.RELEASE");
		springJarDigests.put("2bc36d22beb2749dbf630ca2641bafa30278f13d8f80968c98a0d1d3c4759702", "5.1.16.RELEASE");
		springJarDigests.put("9f28e099b9a744ee71bb0d6df5add0e4918952f05d74704675d237eff5ca0df0", "5.1.18.RELEASE");
		springJarDigests.put("f12582d4a80d9e3274780736d896de0e7e1827b30c4f9c25c3bfe49bacf257e2", "5.1.19.RELEASE");
		springJarDigests.put("0dee11372aff769035f8610421ecb18ab809ac66af424ae3b0ceedb6983989f7", "5.1.20.RELEASE");
		springJarDigests.put("6702b1f7b7440512b9fe7d04f48762ac8b4be65fc2554079a1da4d6285c581f3", "5.1.3.RELEASE");
		springJarDigests.put("7f759c26bfc4697346de39993df48b2dac49f502d5d4e5d69f19054edc4376f5", "5.1.5.RELEASE");
		springJarDigests.put("230fc4bd94573bdd0fade9e492b218338a2260fc737b4ea853b877cc447be994", "5.1.6.RELEASE");
		springJarDigests.put("10fa2771d73d6acf49df96bae9c64d569f6d34564d14d9498f6a52d11850942d", "5.1.7.RELEASE");
		springJarDigests.put("e53ac6c352a41050c9f2186590157bbe61899428f3d62bab772f1ef96f141237", "5.1.9.RELEASE");
		springJarDigests.put("7d8dab8ecc1b1575086603a204cf688ec8fd85ecaeeba00ba87cb1328c54c5ed", "5.2.0.RELEASE");
		springJarDigests.put("f26ed1a9b3de49467948a9b5ca4e7a973a064bc27430fd1b419f075683cc08be", "5.2.10.RELEASE");
		springJarDigests.put("152bcc4a387bde12ed73b6c0895fca44b79e5ac2a07a6f2e3959a33b8730528f", "5.2.11.RELEASE");
		springJarDigests.put("ec519a30fa342ff96f55a8641cc423907ffd193d759dda50c1b77997e11c6457", "5.2.13.RELEASE");
		springJarDigests.put("61b833a6cae1108ad45cd95ed87944d41b412f971a617fbf4f3287380d7b7967", "5.2.14.RELEASE");
		springJarDigests.put("2f93b539d3d71c07f3923386c78e9fad3f06361a84bc9ed7615d38c176824162", "5.2.16.RELEASE");
		springJarDigests.put("9df567b7d52175ba32d6b2bded4f64ef41080abbc7bcfaabed4f4cd343080dbe", "5.2.18.RELEASE");
		springJarDigests.put("2163508fae468a14035ae4afe476803a701078d76a73448224331754822e7626", "5.2.19.RELEASE");
		springJarDigests.put("58f16fa6718d9e2a456036b681b68dc38802c0da6c90feaf1e63a160b3b74cac", "5.2.2.RELEASE");
		springJarDigests.put("b90ec0db31c54cd72550337e239c18765afaf5d85c5a02fc0db42f0149babc53", "5.2.4.RELEASE");
		springJarDigests.put("f22d8034a6795311e642974225058db0b8078864e62c420a431fb46d649a0f54", "5.2.5.RELEASE");
		springJarDigests.put("a646527fce622e348c889f72338967d23831ac32e2b559506ed47e3a7041286b", "5.2.7.RELEASE");
		springJarDigests.put("dc4e0f8014ca6c4ffe02e854e2f3fd548c384f208a69808f08d7ea56ab0849a0", "5.2.8.RELEASE");
		springJarDigests.put("1c58981f2062466f171ee50e48ab9e6b6efe1829e3175633d77dac267c1b76e7", "5.3.0");
		springJarDigests.put("86f7c1cdac78f5fe6e2547d8faef52e8c3528526563b542c4922479f5422c440", "5.3.1");
		springJarDigests.put("2fc52811a5a8bb5684957ba67ab5642d39833be624f2507e2577707e737670b2", "5.3.2");
		springJarDigests.put("9ac9237516f7d53dffa7eb6b03c5da67de418d03826aee9e226c1b1d67baf90a", "5.3.4");
		springJarDigests.put("a5736e63f93f68f32d9785c3a4a74fd956b382d92a55cd123908141cf0d9b220", "5.3.5");
		springJarDigests.put("33331abcdd8acccea43666782a5807127a0d43ffc6abf1c3252fbb27fc3367b2", "5.3.6");
		springJarDigests.put("fbb626312a695294b537150034f7e9fc5563908e02903b8c617d06df60e00380", "5.3.8");
		springJarDigests.put("98a551453f431dce5730ad45b7005d414e844c4d743e442b20f3114a3031d71e", "5.3.11");
		springJarDigests.put("a88c010991f572723109ebd4d9c38974ddb78f4477f97cf48e9d364ec35f3432", "5.3.12");
		springJarDigests.put("b354f54923139b8d86bc594452a6f53329da7b1e0c2a6402f9d9ca24837091ad", "5.3.14");
		springJarDigests.put("f4facec88ada2e86be062f90b3f1d39fd6660de7ecc2dc45afc45fb31e9699b2", "5.3.15");
		springJarDigests.put("23ba3216644c33f10716dc158d33080a5e3f7457e660ec72bdccb26e777f2c74", "5.3.17");
		springJarDigests.put("e962d99bf7b3753cded86ce8ce6b4be5bed27d0b59feeb2a85948e29bba2807d", "5.3.18");
		springJarDigests.put("ab242fb119664df49c64c8af8cfb1932446bdc342d3a56453e34f40fa860f0f4", "5.2.20.RELEASE");
		springJarDigests.put("b7611c96a97b7e9174c0b7d77627c49bea9609887e1608c10f713101018b4bb6", "2.1.1.RELEASE");
		springJarDigests.put("ed800f7ed9005a1cdab19ad0694a0ad3137f9421850beab3709dbeabab5d2a25", "3.0.0.RELEASE");
		springJarDigests.put("f42cc6aee9b78d996ae1b2e763c325a543dde11dcaefd005acfea3be9e86065e", "3.0.1.RELEASE");
		springJarDigests.put("51a5a34da65a4ea44147ec1ba15f393ce542ad043331d4f027c8677bef13dc5b", "3.0.2.RELEASE");
		springJarDigests.put("96eeb8039a1bd2400663b1bc9dbc8f7a5bd01c5939d21b52254251c708784b3a", "3.0.3.RELEASE");
		springJarDigests.put("316d38860ccdad3ab05756d9bfb6adcda94f46c1a60057cd89c7fff4fc906547", "3.0.4.RELEASE");
		springJarDigests.put("25171101cbe9024a4abfb81836b18cec3a9d69b72d293040ca5001d383bcf412", "3.0.5.RELEASE");
		springJarDigests.put("0f2c471b819cf65fba9704725165e34a24207d4a1688528ae4f92409c2c2c742", "3.0.6.RELEASE");
		springJarDigests.put("1c3295cc69571fa1389050ab395b114ec4b07e38f10136e0e1342eb598282ba9", "3.0.7.RELEASE");
		springJarDigests.put("4f3e2ea30fc4a0b4d532e5246fe59ad966c91ac287af7d74024e8a7cda2052a7", "3.0.8.RELEASE");
		springJarDigests.put("a3b42ef2648a8fc05c270a33a5a4e7b407688998d452ded9c96983664f48a2c2", "3.0.9.RELEASE");
		springJarDigests.put("06fe7d2dc2c5628319079a7088532fee5b768e91aeed77c0a567da00dd0a176d", "3.0.10.RELEASE");
		springJarDigests.put("7e803aa3f9341975d0d7d1a2e00803afb6a9eca3f27ab6df883f1316c1a83f66", "3.0.11.RELEASE");
		springJarDigests.put("a3436f618aa4bd6c0fe6ac5c935e0f54c33c0a738ef3f810f82b12ebc15851ac", "3.0.12.RELEASE");
		springJarDigests.put("883fc5069fd85a62d28572d6d05586a358acfed9a0224ee4d5ecceefa4a1ad62", "3.0.14.RELEASE");
		springJarDigests.put("b454b8d90460c6802488e1b381c419cc371b6d480caefcf390bfdb0638437b2a", "3.1.0");
		springJarDigests.put("182b013007224a1503b2baab53bcafe642e5b7a7bd8029a3260cfbf680b1e9e2", "3.1.1");
		springJarDigests.put("3ae7dfe54d4cd1533ab122e32935b85a00ac2efb20a077eb260991d32c1df6a9", "3.1.2");
		springJarDigests.put("cffbe4fa1fb7fbf7e713aa6ea095b21c37ef845cc12c7ec02d0b472cd30be235", "3.1.3");
		springJarDigests.put("91dd6fdd67cc69efe0d10a2130a83815477c3c033a226c991bfe1bba07945ff0", "3.1.4");
		springJarDigests.put("1b07bf3b55d844108670e2d0f42cfe378fbe5ce3b2fd4d577440050182a2f2b1", "3.1.5");
		springJarDigests.put("c0ef37245f521774f9e540bc258981c5931e4c462b246fd452c52f861ebad47b", "3.1.6");
		springJarDigests.put("70290e17dbf2fcb62734fe9dfb21054bb34a14f232bd747f806d2e283713421d", "3.1.7");
		springJarDigests.put("ae74abd31a01574bf957ad05a51dcc6180af0490dc4701da112e82abc2c718a5", "3.2.0");
		springJarDigests.put("909f893ff5db017e1a5181c26672659b38669ee0967caed8998816fc6aac761a", "3.2.1");
		springJarDigests.put("0ad4b649e1b464de0349743cc3a67d6bd0c805579e879b7c53032ad5c01373d6", "3.2.2");
		springJarDigests.put("52c6ae60681d0869888720c83684c6e2d7017ebc399e7794427c2cbdc0c47d72", "3.2.3");
		
		springCachedIntrospectionResultsDigests = new HashMap<>();
		springCachedIntrospectionResultsDigests.put("448c235266cf50f3f0dda1943f162f655ddf085d866d7f166d526c4dcadc8a29", "1.2-rc1");
		springCachedIntrospectionResultsDigests.put("448c235266cf50f3f0dda1943f162f655ddf085d866d7f166d526c4dcadc8a29", "1.2-rc2");
		springCachedIntrospectionResultsDigests.put("448c235266cf50f3f0dda1943f162f655ddf085d866d7f166d526c4dcadc8a29", "1.2.1");
		springCachedIntrospectionResultsDigests.put("448c235266cf50f3f0dda1943f162f655ddf085d866d7f166d526c4dcadc8a29", "1.2.2");
		springCachedIntrospectionResultsDigests.put("448c235266cf50f3f0dda1943f162f655ddf085d866d7f166d526c4dcadc8a29", "1.2.3");
		springCachedIntrospectionResultsDigests.put("448c235266cf50f3f0dda1943f162f655ddf085d866d7f166d526c4dcadc8a29", "1.2.4");
		springCachedIntrospectionResultsDigests.put("b932d7f04848f239dd143b67b70fd7fbe5b534dad03bbbd3b7395b07e7e9410c", "1.2.5");
		springCachedIntrospectionResultsDigests.put("b932d7f04848f239dd143b67b70fd7fbe5b534dad03bbbd3b7395b07e7e9410c", "1.2.6");
		springCachedIntrospectionResultsDigests.put("f18c9203afbcb1fadb40794b5a7ea80c4835bfb53684c55bb53603ec44d22c67", "1.2.8");
		springCachedIntrospectionResultsDigests.put("4c52465f65d789ddfdf069dc4b96361810d55ee5c34a594769ded57fe1149aad", "1.2.9");
		springCachedIntrospectionResultsDigests.put("448c235266cf50f3f0dda1943f162f655ddf085d866d7f166d526c4dcadc8a29", "1.2");
		springCachedIntrospectionResultsDigests.put("be3a9e2f7fbb77f40eda831518d47877cc2cee84040ee9fd0d36832219f29499", "2.0-m1");
		springCachedIntrospectionResultsDigests.put("be3a9e2f7fbb77f40eda831518d47877cc2cee84040ee9fd0d36832219f29499", "2.0-m2");
		springCachedIntrospectionResultsDigests.put("be3a9e2f7fbb77f40eda831518d47877cc2cee84040ee9fd0d36832219f29499", "2.0-m3");
		springCachedIntrospectionResultsDigests.put("be3a9e2f7fbb77f40eda831518d47877cc2cee84040ee9fd0d36832219f29499", "2.0-m4");
		springCachedIntrospectionResultsDigests.put("cb0d9931738a169aa4c117f6b57ff6ac83d204ddbda3f31268008050476fe1a5", "2.0-rc1");
		springCachedIntrospectionResultsDigests.put("cb0d9931738a169aa4c117f6b57ff6ac83d204ddbda3f31268008050476fe1a5", "2.0-rc2");
		springCachedIntrospectionResultsDigests.put("3d2211c75c08fb0cac07d238dc5713d0ac4529693dec8bf97ac0add4a18466ff", "2.0.1");
		springCachedIntrospectionResultsDigests.put("cfd1c5e1376ec430447caefbc40e9ab26096a8826f8bf6807aeebf343f860a1c", "2.0.2");
		springCachedIntrospectionResultsDigests.put("6c703b424fe894c0fa6261c6d8a4f9d18d5107e292cf7599489619239f114068", "2.0.4");
		springCachedIntrospectionResultsDigests.put("6c703b424fe894c0fa6261c6d8a4f9d18d5107e292cf7599489619239f114068", "2.0.5");
		springCachedIntrospectionResultsDigests.put("6c703b424fe894c0fa6261c6d8a4f9d18d5107e292cf7599489619239f114068", "2.0.6");
		springCachedIntrospectionResultsDigests.put("6c703b424fe894c0fa6261c6d8a4f9d18d5107e292cf7599489619239f114068", "2.0.7");
		springCachedIntrospectionResultsDigests.put("6c703b424fe894c0fa6261c6d8a4f9d18d5107e292cf7599489619239f114068", "2.0.8");
		springCachedIntrospectionResultsDigests.put("ac4060593a2576c613fe458880a524e003177abb9cc973026e95f291d2166520", "2.5.1");
		springCachedIntrospectionResultsDigests.put("640bfd278bea06b2dc720ab42fc49bbabd42e5982115a7edd932bbd358823a2e", "2.5.2");
		springCachedIntrospectionResultsDigests.put("9112d87b4ccd789783f381738f90c166d3a6383b199bb222b966fd255ae7340c", "2.5.3");
		springCachedIntrospectionResultsDigests.put("9112d87b4ccd789783f381738f90c166d3a6383b199bb222b966fd255ae7340c", "2.5.5");
		springCachedIntrospectionResultsDigests.put("9112d87b4ccd789783f381738f90c166d3a6383b199bb222b966fd255ae7340c", "2.5.6.SEC01");
		springCachedIntrospectionResultsDigests.put("1a171691ba1e8dac7134ac4e81744e4c170235e6fba23bd8082ced06021f48b5", "2.5.6.SEC02");
		springCachedIntrospectionResultsDigests.put("9112d87b4ccd789783f381738f90c166d3a6383b199bb222b966fd255ae7340c", "2.5.6");
		springCachedIntrospectionResultsDigests.put("ac4060593a2576c613fe458880a524e003177abb9cc973026e95f291d2166520", "2.5");
		springCachedIntrospectionResultsDigests.put("f1abaf4f24c5f10ae85266b30fda5568c09da74289866e271e861b33f2cf6233", "3.0.0.RELEASE");
		springCachedIntrospectionResultsDigests.put("f1abaf4f24c5f10ae85266b30fda5568c09da74289866e271e861b33f2cf6233", "3.0.2.RELEASE");
		springCachedIntrospectionResultsDigests.put("c22483f1556f5a5c7ae6d565de6ab3c19633e9d8328b7ac95cadc832dd797269", "3.0.3.RELEASE");
		springCachedIntrospectionResultsDigests.put("c22483f1556f5a5c7ae6d565de6ab3c19633e9d8328b7ac95cadc832dd797269", "3.0.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("c22483f1556f5a5c7ae6d565de6ab3c19633e9d8328b7ac95cadc832dd797269", "3.0.6.RELEASE");
		springCachedIntrospectionResultsDigests.put("c22483f1556f5a5c7ae6d565de6ab3c19633e9d8328b7ac95cadc832dd797269", "3.0.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("912b1b2d9adf4d6e4894fbb00d840580297980917a7714d56490977fd68ee485", "3.1.1.RELEASE");
		springCachedIntrospectionResultsDigests.put("912b1b2d9adf4d6e4894fbb00d840580297980917a7714d56490977fd68ee485", "3.1.2.RELEASE");
		springCachedIntrospectionResultsDigests.put("8d23c596562a63732c4af68a3e65e7bfd69af2496cb9d28b87d8b8f46168320d", "3.1.4.RELEASE");
		springCachedIntrospectionResultsDigests.put("b4c534e0dbdb7cbb47ea9ab19b89048de3a3fe25abf837951361f05ff56f4051", "3.2.0.RELEASE");
		springCachedIntrospectionResultsDigests.put("4583a7ff7649ceded0ccdf1a8af055145fb4d49746365d2c2d1d96742b68a324", "3.2.1.RELEASE");
		springCachedIntrospectionResultsDigests.put("8da7b0c7ce1edd13c42390038b172bccb60f19946973d5862f6f40e2e30df3b2", "3.2.11.RELEASE");
		springCachedIntrospectionResultsDigests.put("8da7b0c7ce1edd13c42390038b172bccb60f19946973d5862f6f40e2e30df3b2", "3.2.12.RELEASE");
		springCachedIntrospectionResultsDigests.put("8da7b0c7ce1edd13c42390038b172bccb60f19946973d5862f6f40e2e30df3b2", "3.2.14.RELEASE");
		springCachedIntrospectionResultsDigests.put("8da7b0c7ce1edd13c42390038b172bccb60f19946973d5862f6f40e2e30df3b2", "3.2.15.RELEASE");
		springCachedIntrospectionResultsDigests.put("8da7b0c7ce1edd13c42390038b172bccb60f19946973d5862f6f40e2e30df3b2", "3.2.17.RELEASE");
		springCachedIntrospectionResultsDigests.put("7ca6f357f34ac6f9472d86ea078935041ea45318c5cb371a526c9e115255c3b3", "3.2.18.RELEASE");
		springCachedIntrospectionResultsDigests.put("4583a7ff7649ceded0ccdf1a8af055145fb4d49746365d2c2d1d96742b68a324", "3.2.4.RELEASE");
		springCachedIntrospectionResultsDigests.put("18af335c5c28d244824cb31216d7ba6f8d178ba608a5f694a3da85bd3b89c58f", "3.2.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("67a145a8a9205d77fc9d185aea0cddc946822357e7df645f305c0d60b723af4a", "3.2.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("3559f9cda734a0516efb5a72fa6cea004ae50e96f0bf20f8dc1b7d90741f2ca1", "3.2.8.RELEASE");
		springCachedIntrospectionResultsDigests.put("3559f9cda734a0516efb5a72fa6cea004ae50e96f0bf20f8dc1b7d90741f2ca1", "3.2.9.RELEASE");
		springCachedIntrospectionResultsDigests.put("0591c411a21147008fb83cc5e241ed921b271438dac99479da5c0ca3bb1b40f2", "4.0.1.RELEASE");
		springCachedIntrospectionResultsDigests.put("e25682d908e833998ea36ad169a1042241fd228437ebc4e696c97f9972ffccef", "4.0.2.RELEASE");
		springCachedIntrospectionResultsDigests.put("e25682d908e833998ea36ad169a1042241fd228437ebc4e696c97f9972ffccef", "4.0.4.RELEASE");
		springCachedIntrospectionResultsDigests.put("e25682d908e833998ea36ad169a1042241fd228437ebc4e696c97f9972ffccef", "4.0.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("cdb9558412a80c0d6c320b5a7d42eb1153fa32243277e688a2bab34e9b7191e9", "4.0.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("cdb9558412a80c0d6c320b5a7d42eb1153fa32243277e688a2bab34e9b7191e9", "4.0.8.RELEASE");
		springCachedIntrospectionResultsDigests.put("7214730c8f62485edf9c550e2cd60062aaea92efc20963993df9551ad3d76fd5", "4.1.0.RELEASE");
		springCachedIntrospectionResultsDigests.put("c7a74b98d46a7799bb0946c06777c7c495919a9b6862454e58cdaf21765f6989", "4.1.1.RELEASE");
		springCachedIntrospectionResultsDigests.put("c7a74b98d46a7799bb0946c06777c7c495919a9b6862454e58cdaf21765f6989", "4.1.3.RELEASE");
		springCachedIntrospectionResultsDigests.put("c7a74b98d46a7799bb0946c06777c7c495919a9b6862454e58cdaf21765f6989", "4.1.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("c7a74b98d46a7799bb0946c06777c7c495919a9b6862454e58cdaf21765f6989", "4.1.6.RELEASE");
		springCachedIntrospectionResultsDigests.put("c7a74b98d46a7799bb0946c06777c7c495919a9b6862454e58cdaf21765f6989", "4.1.8.RELEASE");
		springCachedIntrospectionResultsDigests.put("c7a74b98d46a7799bb0946c06777c7c495919a9b6862454e58cdaf21765f6989", "4.1.9.RELEASE");
		springCachedIntrospectionResultsDigests.put("1210d06d77e47e9bdb5e657c8cc58081ded09e48d25ce7d2ef16697e07549caf", "4.2.1.RELEASE");
		springCachedIntrospectionResultsDigests.put("1210d06d77e47e9bdb5e657c8cc58081ded09e48d25ce7d2ef16697e07549caf", "4.2.2.RELEASE");
		springCachedIntrospectionResultsDigests.put("1210d06d77e47e9bdb5e657c8cc58081ded09e48d25ce7d2ef16697e07549caf", "4.2.4.RELEASE");
		springCachedIntrospectionResultsDigests.put("1210d06d77e47e9bdb5e657c8cc58081ded09e48d25ce7d2ef16697e07549caf", "4.2.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("1210d06d77e47e9bdb5e657c8cc58081ded09e48d25ce7d2ef16697e07549caf", "4.2.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("0f2f9a511f22bacaf8df52a4fa7c80b04072043b69205945c61ef98722188d99", "4.2.8.RELEASE");
		springCachedIntrospectionResultsDigests.put("03c8db6bb825f217ebf7a2718e78ac2edf2962db28b4a610a36366a916d13c15", "4.3.0.RELEASE");
		springCachedIntrospectionResultsDigests.put("03c8db6bb825f217ebf7a2718e78ac2edf2962db28b4a610a36366a916d13c15", "4.3.1.RELEASE");
		springCachedIntrospectionResultsDigests.put("68bf5bbaf38cabc0b7bc54d56e26e78e5e9254091cb66a78d2eb8e29a876bd6c", "4.3.11.RELEASE");
		springCachedIntrospectionResultsDigests.put("68bf5bbaf38cabc0b7bc54d56e26e78e5e9254091cb66a78d2eb8e29a876bd6c", "4.3.12.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.14.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.16.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.17.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.19.RELEASE");
		springCachedIntrospectionResultsDigests.put("03c8db6bb825f217ebf7a2718e78ac2edf2962db28b4a610a36366a916d13c15", "4.3.2.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.21.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.22.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.24.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.26.RELEASE");
		springCachedIntrospectionResultsDigests.put("1592a968c8cd22afedef8d430ba20db359a956815ec95520805914931489af24", "4.3.27.RELEASE");
		springCachedIntrospectionResultsDigests.put("4a91519d64e3ad5ecab3e1cefbc2e175c5941e8230d8ce54de7b887338d02d84", "4.3.29.RELEASE");
		springCachedIntrospectionResultsDigests.put("68bf5bbaf38cabc0b7bc54d56e26e78e5e9254091cb66a78d2eb8e29a876bd6c", "4.3.3.RELEASE");
		springCachedIntrospectionResultsDigests.put("68bf5bbaf38cabc0b7bc54d56e26e78e5e9254091cb66a78d2eb8e29a876bd6c", "4.3.4.RELEASE");
		springCachedIntrospectionResultsDigests.put("68bf5bbaf38cabc0b7bc54d56e26e78e5e9254091cb66a78d2eb8e29a876bd6c", "4.3.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("68bf5bbaf38cabc0b7bc54d56e26e78e5e9254091cb66a78d2eb8e29a876bd6c", "4.3.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("68bf5bbaf38cabc0b7bc54d56e26e78e5e9254091cb66a78d2eb8e29a876bd6c", "4.3.9.RELEASE");
		springCachedIntrospectionResultsDigests.put("38a47d4367cd76b957de813b8066f5ee19b8a450b4b38acdaca713cf43db4080", "5.0.0.RELEASE");
		springCachedIntrospectionResultsDigests.put("417fd370ca02fbe0a86c28d2bbe768c104a02e6fd50de31770c2df4f790e59ea", "5.0.10.RELEASE");
		springCachedIntrospectionResultsDigests.put("417fd370ca02fbe0a86c28d2bbe768c104a02e6fd50de31770c2df4f790e59ea", "5.0.11.RELEASE");
		springCachedIntrospectionResultsDigests.put("df8081e77e4f85cca548dc9265e6b080da3ff075c2a52e2e7acf0de329d9e948", "5.0.13.RELEASE");
		springCachedIntrospectionResultsDigests.put("df8081e77e4f85cca548dc9265e6b080da3ff075c2a52e2e7acf0de329d9e948", "5.0.14.RELEASE");
		springCachedIntrospectionResultsDigests.put("df8081e77e4f85cca548dc9265e6b080da3ff075c2a52e2e7acf0de329d9e948", "5.0.15.RELEASE");
		springCachedIntrospectionResultsDigests.put("df8081e77e4f85cca548dc9265e6b080da3ff075c2a52e2e7acf0de329d9e948", "5.0.17.RELEASE");
		springCachedIntrospectionResultsDigests.put("f4648837b518f82795216e23726f69e24536f1a8aaff335a810747ce25303136", "5.0.18.RELEASE");
		springCachedIntrospectionResultsDigests.put("38a47d4367cd76b957de813b8066f5ee19b8a450b4b38acdaca713cf43db4080", "5.0.2.RELEASE");
		springCachedIntrospectionResultsDigests.put("f4648837b518f82795216e23726f69e24536f1a8aaff335a810747ce25303136", "5.0.20.RELEASE");
		springCachedIntrospectionResultsDigests.put("20ad82e25bab117d4c804e0648164841067781cc41e7b9e6f485e4d11073a485", "5.0.4.RELEASE");
		springCachedIntrospectionResultsDigests.put("0726931727f081adc18f4cc8a9e12d1bc1bd8d489887bb6de1c1818d59086da3", "5.0.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("0726931727f081adc18f4cc8a9e12d1bc1bd8d489887bb6de1c1818d59086da3", "5.0.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("417fd370ca02fbe0a86c28d2bbe768c104a02e6fd50de31770c2df4f790e59ea", "5.0.8.RELEASE");
		springCachedIntrospectionResultsDigests.put("c16dab0423510596a45160f09315bb432d655fd9abd35b88e9f9de833f6dda13", "5.1.0.RELEASE");
		springCachedIntrospectionResultsDigests.put("c16dab0423510596a45160f09315bb432d655fd9abd35b88e9f9de833f6dda13", "5.1.1.RELEASE");
		springCachedIntrospectionResultsDigests.put("005d47197459ab4ef0945031c4096dab6f47ac87745772b4333c47ceb0b2601b", "5.1.10.RELEASE");
		springCachedIntrospectionResultsDigests.put("005d47197459ab4ef0945031c4096dab6f47ac87745772b4333c47ceb0b2601b", "5.1.12.RELEASE");
		springCachedIntrospectionResultsDigests.put("82940fd349b672b2a341f2b283144eb6000b98b46603987078036a1e14f8c3dd", "5.1.13.RELEASE");
		springCachedIntrospectionResultsDigests.put("82940fd349b672b2a341f2b283144eb6000b98b46603987078036a1e14f8c3dd", "5.1.15.RELEASE");
		springCachedIntrospectionResultsDigests.put("85592077b7e9066793b345cb203252a6934e16da49c9c2b2aa83c4b7fbcfb91c", "5.1.16.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.1.18.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.1.19.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.1.20.RELEASE");
		springCachedIntrospectionResultsDigests.put("c16dab0423510596a45160f09315bb432d655fd9abd35b88e9f9de833f6dda13", "5.1.3.RELEASE");
		springCachedIntrospectionResultsDigests.put("c16dab0423510596a45160f09315bb432d655fd9abd35b88e9f9de833f6dda13", "5.1.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("005d47197459ab4ef0945031c4096dab6f47ac87745772b4333c47ceb0b2601b", "5.1.6.RELEASE");
		springCachedIntrospectionResultsDigests.put("005d47197459ab4ef0945031c4096dab6f47ac87745772b4333c47ceb0b2601b", "5.1.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("005d47197459ab4ef0945031c4096dab6f47ac87745772b4333c47ceb0b2601b", "5.1.9.RELEASE");
		springCachedIntrospectionResultsDigests.put("005d47197459ab4ef0945031c4096dab6f47ac87745772b4333c47ceb0b2601b", "5.2.0.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.2.10.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.2.11.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.2.13.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.2.14.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.2.16.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.2.18.RELEASE");
		springCachedIntrospectionResultsDigests.put("54c008aed433118feaa154f8441c4c8dc44b035ac34fb495446a4b23dd700e2a", "5.2.19.RELEASE");
		springCachedIntrospectionResultsDigests.put("005d47197459ab4ef0945031c4096dab6f47ac87745772b4333c47ceb0b2601b", "5.2.2.RELEASE");
		springCachedIntrospectionResultsDigests.put("82940fd349b672b2a341f2b283144eb6000b98b46603987078036a1e14f8c3dd", "5.2.4.RELEASE");
		springCachedIntrospectionResultsDigests.put("82940fd349b672b2a341f2b283144eb6000b98b46603987078036a1e14f8c3dd", "5.2.5.RELEASE");
		springCachedIntrospectionResultsDigests.put("85592077b7e9066793b345cb203252a6934e16da49c9c2b2aa83c4b7fbcfb91c", "5.2.7.RELEASE");
		springCachedIntrospectionResultsDigests.put("85592077b7e9066793b345cb203252a6934e16da49c9c2b2aa83c4b7fbcfb91c", "5.2.8.RELEASE");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.0");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.1");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.2");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.3");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.4");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.5");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.6");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.7");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.8");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.11");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.12");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.13");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.14");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.15");
		springCachedIntrospectionResultsDigests.put("f0b1dd9f37af5f29e92a7eb0f9891ec7c077ee70252b68b02a749382a4466922", "5.3.17");
		springCachedIntrospectionResultsDigests.put("1e40398b6fd070af5b6a75cc6329c1f3c897745b7a1b5f686e893066d0b7c61b", "5.3.18");
		springCachedIntrospectionResultsDigests.put("df420f4867849871af01edaf003e95377661ddd9012da38ffeed9fa32260e288", "5.2.20.RELEASE");
		
		springRoutingFunctionDigests = new HashMap<>();
		springRoutingFunctionDigests.put("3ba1a16fb3a69b7fb5014d52254c9b4fd4ff07b987276ca8bc4dd962c4412b90", "2.1.1.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.0.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.1.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.2.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.3.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.4.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.5.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.6.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.7.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.8.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.9.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.10.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.11.RELEASE");
		springRoutingFunctionDigests.put("14ae35dcb37f1bd351c66772e87a9d02bd261108a02352fc41a532267c006b57", "3.0.12.RELEASE");
		springRoutingFunctionDigests.put("cb2aabf3315ed60f2a89899d29e628c150e23692f730a061da9cbca0e816569a", "3.0.14.RELEASE");
		springRoutingFunctionDigests.put("efd54db2da5181f6b25546a971bfd84939fae7994d75cd9f36e684b9f6064449", "3.1.0");
		springRoutingFunctionDigests.put("a6accf29f5e4e39a85a3994d8504fd9914370bf9f3d5eec021ae912fb0f8379f", "3.1.1");
		springRoutingFunctionDigests.put("c907520d55f8033131f9e63db780445ed07ea5ea95120bed22b66c702e7df019", "3.1.2");
		springRoutingFunctionDigests.put("c907520d55f8033131f9e63db780445ed07ea5ea95120bed22b66c702e7df019", "3.1.3");
		springRoutingFunctionDigests.put("c907520d55f8033131f9e63db780445ed07ea5ea95120bed22b66c702e7df019", "3.1.4");
		springRoutingFunctionDigests.put("c907520d55f8033131f9e63db780445ed07ea5ea95120bed22b66c702e7df019", "3.1.5");
		springRoutingFunctionDigests.put("8d61a523c4148814532e9d017e7d20d93ea7d1c92e8c0c645658443344a739ce", "3.1.6");
		springRoutingFunctionDigests.put("bad491497494a69c0223d31cb706abd309e0fe281e8dd0e87bdc6876dd9db11d", "3.1.7");
		springRoutingFunctionDigests.put("0bce6003ef4a9777f4cfa9ad8455c6a4ff1df016f4f975478d8db053a5323406", "3.2.0");
		springRoutingFunctionDigests.put("0bce6003ef4a9777f4cfa9ad8455c6a4ff1df016f4f975478d8db053a5323406", "3.2.1");
		springRoutingFunctionDigests.put("eed9e010b941e146eb80dc5a942b66b559862a6c6b0d844aadb13808b28bd451", "3.2.2");
		springRoutingFunctionDigests.put("0a71e29d2c2643baf87e2ffa25f9dea20c4d5e4d5d3f66e83aba6debb24fd075", "3.2.3");
	}

	public static List<String> getLog4j1Md5Entries() {
		return Arrays.asList("/log4j/Category.class", "/log4j/MDC.class", "/log4j/NDC.class", "/log4j/net/JMSSink.class",
				"/log4j/helpers/PatternParser.class", "/log4j/net/SMTPAppender.class");
	}

	public static List<String> getLog4j2Md5Entries() {
		return Arrays.asList("/log4j/core/appender/rolling/RollingFileManager.class", "/log4j/core/config/LoggerConfig.class",
				"/log4j/core/appender/AsyncAppender.class", "/log4j/core/lookup/Interpolator.class",
				"/log4j/core/config/AppenderControl.class",
				"/log4j/core/impl/ThreadContextDataInjector$ForCopyOnWriteThreadContextMap.class",
				"/log4j/core/appender/OutputStreamManager.class", "/log4j/core/async/AsyncLogger.class",
				"/log4j/core/net/JndiManager.class");
	}

	public static List<String> getSpringSha256Entries() {
		return Arrays.asList(
				"org/springframework/beans/CachedIntrospectionResults.class",
				"org/springframework/cloud/function/context/config/RoutingFunction.class");
	}

	@SuppressWarnings("unchecked")
	public static String classifyLog4j2Version(Map<String, String> entryMd5Map) {

		final String[] classFileNames = new String[] { "RollingFileManager.class", "LoggerConfig.class", "AppenderControl.class",
				"ThreadContextDataInjector$ForCopyOnWriteThreadContextMap.class", "AsyncAppender.class",
				"OutputStreamManager.class", "AsyncLogger.class", "Interpolator.class", "JndiManager.class" };

		final Map<String, String>[] digestMaps = new Map[] { log4j2RollingFileManagerDigests, log4j2LoggerConfigDigests,
				log4j2AppenderControlDigests, log4j2ThreadContextMapDigests, log4j2AsyncAppenderDigests,
				log4j2OutputStreamManagerDigests, log4j2AsyncLoggerDigests, log4j2InterpolatorDigests, jndiManagerDigests };

		for (int i = 0; i < classFileNames.length; i++) {
			String version = detectLog4j2Version(classFileNames[i], entryMd5Map, digestMaps[i]);
			if (version != null) {
				return version;
			}
		}

		return null;
	}

	private static String detectLog4j2Version(String classFileName, Map<String, String> entryMd5Map,
			Map<String, String> digests) {
		String md5 = entryMd5Map.get(classFileName);
		if (md5 == null) {
			return null;
		}

		return digests.get(md5);
	}
	
	@SuppressWarnings("unchecked")
	public static String classifySpringVersion(Map<String, String> entryMd5Map) {

		final String[] classFileNames = new String[] { "CachedIntrospectionResults.class", "RoutingFunction.class" };

		final Map<String, String>[] digestMaps = new Map[] { springCachedIntrospectionResultsDigests, springRoutingFunctionDigests };

		for (int i = 0; i < classFileNames.length; i++) {
			String version = detectSpringVersion(classFileNames[i], entryMd5Map, digestMaps[i]);
			if (version != null) {
				return version;
			}
		}

		return null;
	}
	
	public static String classifySpringVersionByJarHash(byte[] sha256Hash){
		String hash = toHex(sha256Hash);
		return springJarDigests.get(hash);
	}

	private static String detectSpringVersion(String classFileName, Map<String, String> entryMd5Map,
			Map<String, String> digests) {
		String sha256 = entryMd5Map.get(classFileName);
		if (sha256 == null) {
			return null;
		}

		return digests.get(sha256);
	}

	public static String classifyLog4j1Version(Map<String, String> entryMd5Map) {
		String categoryMd5 = entryMd5Map.get("Category.class");
		String ndcMd5 = entryMd5Map.get("NDC.class");
		String mdcMd5 = entryMd5Map.get("MDC.class");
		String jmsSinkMd5 = entryMd5Map.get("JMSSink.class");
		String patternParserMd5 = entryMd5Map.get("PatternParser.class");
		String smtpAppenderMd5 = entryMd5Map.get("SMTPAppender.class");

		if (categoryMd5 == null) {
			return null;
		}

		if (categoryMd5.equals("f1dda8732d825c58248e4c85f6bfff80")) {
			if (ndcMd5 == null) {
				return null;
			}

			if (ndcMd5.equals("1d79e7ecd65f4ec0560420024a8086f2")) {
				return "1.2.13";
			}
			else if (ndcMd5.equals("b5223239f2810943933b54d8ea681763")) {
				return "1.2.14";
			}
		} else if (categoryMd5.equals("ffbeb79ef0d29a902b84c8c06cac91ae")) {
			if (mdcMd5 == null) {
				return null;
			}

			if (mdcMd5.equals("cc556397bdabc4995892b18d2e6246f0")) {
				return "1.2.5";
			} else if (mdcMd5.equals("f74d8a96370d7776331dde8718a12990")) {
				return "1.2.6";
			} else if (mdcMd5.equals("8543bd826940dd588cd63b1118a82e90")) {
				return "1.2.7";
			}
		} else {
			if (jmsSinkMd5 != null && jmsSinkMd5.equals("016dbb16c0d5509c13dad7b483b4e648")) {
				return "1.2.18.0";
			} else if (smtpAppenderMd5 != null && smtpAppenderMd5.equals("3bff44742e88190fa9f200826af64d9c")) {
				return "1.2.18.3";
			} else if (smtpAppenderMd5 != null && smtpAppenderMd5.equals("7f938ce7dc9df0389d38d3ca40296015")) {
				return "1.2.18.4";
			} else if (mdcMd5 != null && mdcMd5.equals("8da7e55001d400655635bbbbc3381ba5")) {
				if (patternParserMd5 != null && patternParserMd5.equals("619e0839a36f541a49016e42c99db710")) {
					return "1.2.18.1";
				} else if (patternParserMd5 != null && patternParserMd5.equals("4848724cd715a2e855d1413a1e15c7c3")) {
					return "1.2.18.2";
				} else {
					return log4j1Digests.get(categoryMd5);
				}
			} else if (mdcMd5 != null && mdcMd5.equals("4bb635421ade486060d68134de4ac74e")) {
				return "1.2.19";
			}

			return log4j1Digests.get(categoryMd5);
		}

		return null;
	}

	public static Map<String, String> generateSignature(File f) {
		Map<String, String> digests = new LinkedHashMap<>();
		ZipInputStream zis = null;
		ZipEntry entry = null;
		try {
			zis = new ZipInputStream(new FileInputStream(f));
			while (true) {
				entry = zis.getNextEntry();
				if (entry == null) {
					break;
				}

				if (entry.getName().endsWith("/")) {
					continue;
				}

				String md5 = md5(zis);
				digests.put(entry.getName(), md5);
			}
			return digests;
		} catch (IOException e) {
			throw new IllegalStateException("cannot load zip entry " + entry, e);
		} finally {
			IoUtils.ensureClose(zis);
		}
	}

	public static String md5(InputStream is) {
		return hash(is, "MD5");
	}
	

	public static String sha256(InputStream is) {
		return hash(is, "SHA-256");
	}

	/**
	 * @param is
	 * @param algorithm
	 * @return
	 */
	public static String hash(InputStream is, String algorithm) {
		try {
			MessageDigest digest = MessageDigest.getInstance(algorithm);
			byte[] b = new byte[8192];
			while( true ) {
				int len = is.read(b);
				if( len < 0 ) {
					break;
				}
				digest.update(b, 0, len);
			}

			return toHex(digest.digest());
		}
		catch( NoSuchAlgorithmException e ) {
			throw new UnsupportedOperationException(algorithm + " is not supported");
		}
		catch( IOException e ) {
			throw new IllegalStateException(algorithm + " error", e);
		}
	}

	private static String toHex(byte[] data) {
		char[] hex = new char[data.length * 2];
		for (int i = 0; i < data.length; i++) {
			hex[i * 2] = HEX_CODES[(data[i] >> 4) & 0xF];
			hex[i * 2 + 1] = HEX_CODES[data[i] & 0xF];
		}
		return new String(hex);
	}

	public static void main(String[] args) throws IOException {
		File[] files = new File(args[0]).listFiles();
		for (File f : files) {
			if (f.getName().endsWith(".sig")) {
				continue;
			}

			FileOutputStream fos = null;
			try {
				fos = new FileOutputStream(new File(f.getAbsolutePath() + ".sig"));
				Map<String, String> signatures = generateSignature(f);
				System.out.println(f.getAbsolutePath());

				for (String name : signatures.keySet()) {
					String md5 = signatures.get(name);
					String line = md5 + " " + name + "\n";
					System.out.print(line);

					fos.write(line.getBytes("utf-8"));
				}

				System.out.println("---");
			} finally {
				IoUtils.ensureClose(fos);
			}
		}
	}
}
